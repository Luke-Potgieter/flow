"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[2604],{3905:function(e,t,n){n.d(t,{Zo:function(){return m},kt:function(){return g}});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=o.createContext({}),c=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},m=function(e){var t=c(e.components);return o.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),d=c(n),g=a,u=d["".concat(l,".").concat(g)]||d[g]||p[g]||i;return n?o.createElement(u,r(r({ref:t},m),{},{components:n})):o.createElement(u,r({ref:t},m))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,r=new Array(i);r[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,r[1]=s;for(var c=2;c<i;c++)r[c]=n[c];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},9161:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return c},toc:function(){return m},default:function(){return d}});var o=n(7462),a=n(3366),i=(n(7294),n(3905)),r=["components"],s={},l="Working with logs and statistics",c={unversionedId:"reference/working-logs-stats",id:"reference/working-logs-stats",title:"Working with logs and statistics",description:"Your logs and stats collections",source:"@site/docs/reference/working-logs-stats.md",sourceDirName:"reference",slug:"/reference/working-logs-stats",permalink:"/reference/working-logs-stats",editUrl:"https://github.com/estuary/flow/edit/master/site/docs/reference/working-logs-stats.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Composing with conditionals",permalink:"/reference/reduction-strategies/composing-with-conditionals"}},m=[{value:"Accessing logs",id:"accessing-logs",children:[{value:"Accessing logs from the command line",id:"accessing-logs-from-the-command-line",children:[],level:3},{value:"Accessing logs by materialization",id:"accessing-logs-by-materialization",children:[],level:3}],level:2}],p={toc:m};function d(e){var t=e.components,n=(0,a.Z)(e,r);return(0,i.kt)("wrapper",(0,o.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"working-with-logs-and-statistics"},"Working with logs and statistics"),(0,i.kt)("p",null,"Your ",(0,i.kt)("a",{parentName:"p",href:"/concepts/advanced/logs-stats"},(0,i.kt)("inlineCode",{parentName:"a"},"logs")," and ",(0,i.kt)("inlineCode",{parentName:"a"},"stats")," collections"),"\nare useful for debugging and monitoring catalog tasks."),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Beta")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Access to statistics is still a work in progress. For now, this documentation deals strictly with logs."))),(0,i.kt)("h2",{id:"accessing-logs"},"Accessing logs"),(0,i.kt)("p",null,"You can access logs by materializing them to an external endpoint, or from the command line."),(0,i.kt)("p",null,"For illustrative purposes, the following sections use the word counts example from the ",(0,i.kt)("a",{parentName:"p",href:"/getting-started/flow-tutorials/hello-flow"},"Flow tutorial"),"."),(0,i.kt)("h3",{id:"accessing-logs-from-the-command-line"},"Accessing logs from the command line"),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Beta")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Enhancements to this workflow are coming soon."))),(0,i.kt)("p",null,"From the command line, you can access logs by printing the journals that comprise them.\nThis workflow is ideal if you require logs to debug specific catalog tasks,\nas logs are divided into journals per partition, and each partition maps to a task."),(0,i.kt)("p",null,"Say you work for Acme Co, and you want to print logs for the materialization ",(0,i.kt)("inlineCode",{parentName:"p"},"materialize-word-counts"),".\nYou need to find the name of the correct journal.\nBegin by printing a list of active journals in your environment:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-console"},"flowctl journals list\n")),(0,i.kt)("p",null,"Each task in the catalog will have a journal in the ",(0,i.kt)("inlineCode",{parentName:"p"},"logs")," collection beginning with ",(0,i.kt)("inlineCode",{parentName:"p"},"ops/acmeCo/logs"),".\nLook for the name of the desired task.\nIn this case, the journal you\u2019re looking for is: ",(0,i.kt)("inlineCode",{parentName:"p"},"ops/acmeCo/logs/kind=materialization/name=acmeCo%2Fpostgres%2Fmaterialize-word-counts/pivot=00 ")),(0,i.kt)("p",null,"Print the contents of the journal to view the logs:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-console"},"flowctl journals read -l name=ops/acmeCo/logs/kind=materialization/name=acmeCo%2Fpostgres%2Fmaterialize-word-counts/pivot=00\n")),(0,i.kt)("h3",{id:"accessing-logs-by-materialization"},"Accessing logs by materialization"),(0,i.kt)("p",null,"You can materialize your ",(0,i.kt)("inlineCode",{parentName:"p"},"logs")," collection to an external system.\nThis is typically the preferred message if you\u2019d like to work with logs for all tasks; in other words, the entire collection."),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Be sure to add a ",(0,i.kt)("a",{parentName:"p",href:"../../concepts/materialization/#partition-selectors"},"partition selector")," to exclude the logs of the materialization\nitself. Otherwise, you could trigger an infinite loop in which the connector\nmaterializes its own logs, logs that event, and so on."))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"acmeCo/postgres/logs:\n  endpoint:\n    connector:\n      image: ghcr.io/estuary/materialize-webhook:dev\n      config:\n        address: my.webhook.com\n  bindings:\n    - resource:\n        relativePath: /log/wordcount\n      source: ops/acmeCo/logs\n      # Exclude the logs of this materialization to avoid an infinite loop.\n      partitions:\n        exclude:\n          name: ['acmeCo/postgres/logs']\n")))}d.isMDXComponent=!0}}]);