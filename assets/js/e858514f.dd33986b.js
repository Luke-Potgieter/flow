"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[5228],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>d});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var s=r.createContext({}),p=function(e){var t=r.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},c=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=p(a),d=n,h=u["".concat(s,".").concat(d)]||u[d]||m[d]||o;return a?r.createElement(h,i(i({ref:t},c),{},{components:a})):r.createElement(h,i({ref:t},c))}));function d(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,i=new Array(o);i[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var p=2;p<o;p++)i[p]=a[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}u.displayName="MDXCreateElement"},6383:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var r=a(7462),n=(a(7294),a(3905));const o={},i="Google Firestore to Snowflake",l={unversionedId:"guides/system-specific-dataflows/firestore-to-dwh",id:"guides/system-specific-dataflows/firestore-to-dwh",title:"Google Firestore to Snowflake",description:"This guide walks you through the process of creating an",source:"@site/docs/guides/system-specific-dataflows/firestore-to-dwh.md",sourceDirName:"guides/system-specific-dataflows",slug:"/guides/system-specific-dataflows/firestore-to-dwh",permalink:"/guides/system-specific-dataflows/firestore-to-dwh",draft:!1,editUrl:"https://github.com/estuary/flow/edit/master/site/docs/guides/system-specific-dataflows/firestore-to-dwh.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"System-specific Data Flows",permalink:"/guides/system-specific-dataflows/"},next:{title:"Amazon S3 to Snowflake",permalink:"/guides/system-specific-dataflows/s3-to-snowflake"}},s={},p=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Introduction",id:"introduction",level:2},{value:"Capture from Firestore",id:"capture-from-firestore",level:2},{value:"Materialize to Snowflake",id:"materialize-to-snowflake",level:2},{value:"What&#39;s next?",id:"whats-next",level:2}],c={toc:p};function m(e){let{components:t,...a}=e;return(0,n.kt)("wrapper",(0,r.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"google-firestore-to-snowflake"},"Google Firestore to Snowflake"),(0,n.kt)("p",null,"This guide walks you through the process of creating an\nend-to-end real-time Data Flow from Google Firestore to Snowflake using Estuary Flow."),(0,n.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,n.kt)("p",null,"You'll need:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"(Recommended) understanding of the ",(0,n.kt)("a",{parentName:"p",href:"/concepts/#essential-concepts"},"basic Flow concepts"),".")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Access to the ",(0,n.kt)("a",{parentName:"p",href:"http://dashboard.estuary.dev"},(0,n.kt)("strong",{parentName:"a"},"Flow web application"))," through an Estuary account.\nIf you don't have one, visit the web app to register for your free trial.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"A ",(0,n.kt)("strong",{parentName:"p"},"Firestore database")," that contains the data you'd like to move to Snowflake. You ",(0,n.kt)("a",{parentName:"p",href:"https://cloud.google.com/firestore/docs/create-database-web-mobile-client-library"},"create this as part of a Google Firebase project"),".")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"A Google service account with:"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Read access to your Firestore database, via ",(0,n.kt)("a",{parentName:"p",href:"https://cloud.google.com/datastore/docs/access/iam"},"roles/datastore.viewer"),".\nYou can assign this role when you ",(0,n.kt)("a",{parentName:"p",href:"https://cloud.google.com/iam/docs/creating-managing-service-accounts#creating"},"create the service account"),", or ",(0,n.kt)("a",{parentName:"p",href:"https://cloud.google.com/iam/docs/granting-changing-revoking-access#single-role"},"add it to an existing service account"),".")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"A generated ",(0,n.kt)("a",{parentName:"p",href:"https://cloud.google.com/iam/docs/creating-managing-service-account-keys#creating"},"JSON service account key")," for the account.")))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"A Snowflake account with:"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"A target ",(0,n.kt)("strong",{parentName:"p"},"database"),", ",(0,n.kt)("strong",{parentName:"p"},"schema"),", and virtual ",(0,n.kt)("strong",{parentName:"p"},"warehouse"),"; and a ",(0,n.kt)("strong",{parentName:"p"},"user")," with a ",(0,n.kt)("strong",{parentName:"p"},"role")," assigned that grants the appropriate access levels to these resources.\n",(0,n.kt)("a",{parentName:"p",href:"/reference/Connectors/materialization-connectors/Snowflake#setup"},"You can use a script to quickly create all of these items.")," Have these details on hand for setup with Flow.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"The account identifier and host URL noted. ",(0,n.kt)("a",{parentName:"p",href:"https://docs.snowflake.com/en/user-guide/admin-account-identifier.html#where-are-account-identifiers-used"},"The URL is formatted using the account identifier"),". For example, you might have the account identifier ",(0,n.kt)("inlineCode",{parentName:"p"},"orgname-accountname.snowflakecomputing.com"),"."))))),(0,n.kt)("h2",{id:"introduction"},"Introduction"),(0,n.kt)("p",null,"In Estuary Flow, you create ",(0,n.kt)("strong",{parentName:"p"},"Data Flows")," to transfer data from ",(0,n.kt)("strong",{parentName:"p"},"source")," systems to ",(0,n.kt)("strong",{parentName:"p"},"destination")," systems in real time.\nIn this use case, your source is an Google Firestore NoSQL database and your destination is a Snowflake data warehouse."),(0,n.kt)("p",null,"After following this guide, you'll have a Data Flow that comprises:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"A ",(0,n.kt)("strong",{parentName:"li"},"capture"),", which ingests data from Firestore"),(0,n.kt)("li",{parentName:"ul"},"Several ",(0,n.kt)("strong",{parentName:"li"},"collection"),", cloud-backed copies of ",(0,n.kt)("a",{parentName:"li",href:"https://cloud.google.com/firestore/docs/data-model"},"Firestore collections")," in the Flow system"),(0,n.kt)("li",{parentName:"ul"},"A ",(0,n.kt)("strong",{parentName:"li"},"materialization"),", which pushes the collections to Snowflake")),(0,n.kt)("p",null,"The capture and materialization rely on plug-in components called ",(0,n.kt)("strong",{parentName:"p"},"connectors"),".\nWe'll walk through how to configure the ",(0,n.kt)("a",{parentName:"p",href:"/reference/Connectors/capture-connectors/google-firestore"},"Firestore")," and ",(0,n.kt)("a",{parentName:"p",href:"/reference/Connectors/materialization-connectors/Snowflake"},"Snowflake")," connectors to integrate these systems with Flow."),(0,n.kt)("h2",{id:"capture-from-firestore"},"Capture from Firestore"),(0,n.kt)("p",null,"You'll first create a capture to connect to your Firestore database, which will yield one Flow collection for each ",(0,n.kt)("a",{parentName:"p",href:"https://cloud.google.com/firestore/docs/data-model"},"Firestore collection")," in your database."),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Go to the Flow web application at ",(0,n.kt)("a",{parentName:"p",href:"https://dashboard.estuary.dev/"},"dashboard.estuary.dev")," and sign in using the\ncredentials provided by your Estuary account manager.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Click the ",(0,n.kt)("strong",{parentName:"p"},"Captures")," tab and choose ",(0,n.kt)("strong",{parentName:"p"},"New Capture"),".")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Click the ",(0,n.kt)("strong",{parentName:"p"},"Google Firestore")," tile."),(0,n.kt)("p",{parentName:"li"},"A form appears with the properties required for a Firestore capture.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Type a name for your capture."),(0,n.kt)("p",{parentName:"li"},"Your capture name must begin with a ",(0,n.kt)("a",{parentName:"p",href:"/concepts/catalogs#namespace"},"prefix")," to which you ",(0,n.kt)("a",{parentName:"p",href:"/reference/authentication"},"have access"),"."),(0,n.kt)("p",{parentName:"li"},"Click inside the ",(0,n.kt)("strong",{parentName:"p"},"Name")," field to generate a drop-down menu of available prefixes, and select your prefix.\nAppend a unique capture name after the ",(0,n.kt)("inlineCode",{parentName:"p"},"/")," to create the full name, for example, ",(0,n.kt)("inlineCode",{parentName:"p"},"acmeCo/myFirestoreCapture"),".")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Fill out the required properties for Firestore."),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Database"),": Flow can autodetect the database name, but you may optionally specify it here. This is helpful if the service account used has access to multiple Firebase projects. Your database name usually follows the format ",(0,n.kt)("inlineCode",{parentName:"p"},"projects/$PROJECTID/databases/(default)"),".")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Credentials"),": The JSON service account key created per the ",(0,n.kt)("a",{parentName:"p",href:"#prerequisites"},"prerequisites"),".")))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Click ",(0,n.kt)("strong",{parentName:"p"},"Next"),"."),(0,n.kt)("p",{parentName:"li"},"Flow uses the provided configuration to initiate a connection with Firestore."),(0,n.kt)("p",{parentName:"li"},"It maps each available Firestore collection to a possible Flow collection. It also generates a capture specification and minimal schemas for each collection."),(0,n.kt)("p",{parentName:"li"},"You can use the ",(0,n.kt)("strong",{parentName:"p"},"Collection Selector")," to remove or modify collections. You'll have the chance to tighten up each collection's JSON schema later, when you materialize to Snowflake."),(0,n.kt)("div",{parentName:"li",className:"admonition admonition-tip alert alert--success"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"If you make any changes in the collection editor, click ",(0,n.kt)("strong",{parentName:"p"},"Next")," again."))),(0,n.kt)("div",{parentName:"li",className:"admonition admonition-tip alert alert--success"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"If you'd rather work on the specification files in their native YAML format, you can use the ",(0,n.kt)("a",{parentName:"p",href:"/concepts/flowctl"},"flowctl")," CLI. flowctl provides a developer-focused path to build full Data Flows in your preferred development environment.")))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Once you're satisfied with the collections to be captured, click ",(0,n.kt)("strong",{parentName:"p"},"Save and publish"),"."),(0,n.kt)("p",{parentName:"li"},"You'll see a notification when the capture publishes successfully."),(0,n.kt)("p",{parentName:"li"},"The data currently in your Firestore database has been captured, and future updates to it will be captured continuously.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Click ",(0,n.kt)("strong",{parentName:"p"},"Materialize Collections")," to continue."))),(0,n.kt)("h2",{id:"materialize-to-snowflake"},"Materialize to Snowflake"),(0,n.kt)("p",null,"Next, you'll add a Snowflake materialization to connect the captured data to its destination: your data warehouse."),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"On the ",(0,n.kt)("strong",{parentName:"p"},"Create Materialization")," page, search for and select the ",(0,n.kt)("strong",{parentName:"p"},"Snowflake")," tile."),(0,n.kt)("p",{parentName:"li"},"A form appears with the properties required for a Snowflake materialization.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Choose a unique name for your materialization like you did when naming your capture; for example, ",(0,n.kt)("inlineCode",{parentName:"p"},"acmeCo/mySnowflakeMaterialization"),".")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Fill out the required properties for Snowflake (you should have most of these handy from the ",(0,n.kt)("a",{parentName:"p",href:"#prerequisites"},"prerequisites"),")."),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Host URL")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Account")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"User")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Password")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Database")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Schema")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Warehouse"),": optional"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Role"),": optional"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Click ",(0,n.kt)("strong",{parentName:"p"},"Next"),"."),(0,n.kt)("p",{parentName:"li"},"Flow uses the provided configuration to initiate a connection to Snowflake."),(0,n.kt)("p",{parentName:"li"},"You'll be notified if there's an error. In that case, fix the configuration form or Snowflake setup as needed and click ",(0,n.kt)("strong",{parentName:"p"},"Next")," to try again."),(0,n.kt)("p",{parentName:"li"},"Once the connection is successful, the Endpoint Config collapses and the Collection Selector becomes prominent.\nIt shows each collection you captured previously.\nEach of them will be mapped to a Snowflake table.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"In the ",(0,n.kt)("strong",{parentName:"p"},"Collection Selector"),", fill in the ",(0,n.kt)("strong",{parentName:"p"},"Table")," field for each collection."),(0,n.kt)("p",{parentName:"li"},"The collections you just created have already been selected, but you must provide names for the tables to which they'll be materialized in Snowflake.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"For each table, choose whether to ",(0,n.kt)("a",{parentName:"p",href:"/reference/Connectors/materialization-connectors/Snowflake#delta-updates"},"enable delta updates"),".")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"For each collection, apply a stricter schema to be used for the materialization."),(0,n.kt)("p",{parentName:"li"},"Firestore has a flat data structure.\nTo materialize data effectively from Firestore to Snowflake, you should apply a schema can translate to a table structure.\nFlow's ",(0,n.kt)("strong",{parentName:"p"},"Schema Inference")," tool can help."),(0,n.kt)("ol",{parentName:"li"},(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"In the Collection Selector, choose a collection and click its ",(0,n.kt)("strong",{parentName:"p"},"Specification")," tab.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Click ",(0,n.kt)("strong",{parentName:"p"},"Schema Inference")),(0,n.kt)("p",{parentName:"li"},"The Schema Inference window appears. Flow scans the data in your collection and infers a new schema, called the ",(0,n.kt)("inlineCode",{parentName:"p"},"readSchema"),", to use for the materialization.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Review the new schema and click ",(0,n.kt)("strong",{parentName:"p"},"Apply Inferred Schema"),".")))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Click ",(0,n.kt)("strong",{parentName:"p"},"Save and Publish"),". You'll see a notification when the full Data Flow publishes successfully."))),(0,n.kt)("h2",{id:"whats-next"},"What's next?"),(0,n.kt)("p",null,"Your Data Flow has been deployed, and will run continuously until it's stopped. Updates in your Firestore database will be reflected in your Snowflake table as they occur."),(0,n.kt)("p",null,"You can advance your Data Flow by adding a ",(0,n.kt)("strong",{parentName:"p"},"derivation"),". Derivations are real-time data transformations.\nSee the ",(0,n.kt)("a",{parentName:"p",href:"/guides/create-derivation"},"guide to create a derivation"),"."))}m.isMDXComponent=!0}}]);