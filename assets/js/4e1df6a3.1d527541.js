"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[7723],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=a.createContext({}),s=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=s(e.components);return a.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,c=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=s(n),m=r,f=u["".concat(c,".").concat(m)]||u[m]||d[m]||o;return n?a.createElement(f,i(i({ref:t},p),{},{components:n})):a.createElement(f,i({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=u;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var s=2;s<o;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},8215:function(e,t,n){var a=n(7294);t.Z=function(e){var t=e.children,n=e.hidden,r=e.className;return a.createElement("div",{role:"tabpanel",hidden:n,className:r},t)}},6396:function(e,t,n){n.d(t,{Z:function(){return u}});var a=n(7462),r=n(7294),o=n(2389),i=n(9443);var l=function(){var e=(0,r.useContext)(i.Z);if(null==e)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return e},c=n(3616),s=n(6010),p="tabItem_vU9c";function d(e){var t,n,o,i=e.lazy,d=e.block,u=e.defaultValue,m=e.values,f=e.groupId,h=e.className,v=r.Children.map(e.children,(function(e){if((0,r.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),k=null!=m?m:v.map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes}})),y=(0,c.lx)(k,(function(e,t){return e.value===t.value}));if(y.length>0)throw new Error('Docusaurus error: Duplicate values "'+y.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var g=null===u?u:null!=(t=null!=u?u:null==(n=v.find((function(e){return e.props.default})))?void 0:n.props.value)?t:null==(o=v[0])?void 0:o.props.value;if(null!==g&&!k.some((function(e){return e.value===g})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+g+'" but none of its children has the corresponding value. Available values are: '+k.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var N=l(),w=N.tabGroupChoices,b=N.setTabGroupChoices,C=(0,r.useState)(g),T=C[0],x=C[1],O=[],S=(0,c.o5)().blockElementScrollPositionUntilNextRender;if(null!=f){var j=w[f];null!=j&&j!==T&&k.some((function(e){return e.value===j}))&&x(j)}var E=function(e){var t=e.currentTarget,n=O.indexOf(t),a=k[n].value;a!==T&&(S(t),x(a),null!=f&&b(f,a))},B=function(e){var t,n=null;switch(e.key){case"ArrowRight":var a=O.indexOf(e.currentTarget)+1;n=O[a]||O[0];break;case"ArrowLeft":var r=O.indexOf(e.currentTarget)-1;n=O[r]||O[O.length-1]}null==(t=n)||t.focus()};return r.createElement("div",{className:"tabs-container"},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.Z)("tabs",{"tabs--block":d},h)},k.map((function(e){var t=e.value,n=e.label,o=e.attributes;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:T===t?0:-1,"aria-selected":T===t,key:t,ref:function(e){return O.push(e)},onKeyDown:B,onFocus:E,onClick:E},o,{className:(0,s.Z)("tabs__item",p,null==o?void 0:o.className,{"tabs__item--active":T===t})}),null!=n?n:t)}))),i?(0,r.cloneElement)(v.filter((function(e){return e.props.value===T}))[0],{className:"margin-vert--md"}):r.createElement("div",{className:"margin-vert--md"},v.map((function(e,t){return(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==T})}))))}function u(e){var t=(0,o.Z)();return r.createElement(d,(0,a.Z)({key:String(t)},e))}},1616:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return p},metadata:function(){return d},toc:function(){return u},default:function(){return f}});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),i=n(6396),l=n(8215),c=["components"],s={},p="flowctl",d={unversionedId:"concepts/flowctl",id:"concepts/flowctl",title:"flowctl",description:"The flowctl command-line interface is used to test, develop, and deploy Flow catalogs.",source:"@site/docs/concepts/flowctl.md",sourceDirName:"concepts",slug:"/concepts/flowctl",permalink:"/concepts/flowctl",editUrl:"https://github.com/estuary/flow/edit/master/site/docs/concepts/flowctl.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Derivations",permalink:"/concepts/derivations"},next:{title:"Imports",permalink:"/concepts/import"}},u=[{value:"Build directory",id:"build-directory",children:[{value:"TypeScript code generation",id:"typescript-code-generation",children:[],level:3}],level:2}],m={toc:u};function f(e){var t=e.components,n=(0,r.Z)(e,c);return(0,o.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"flowctl"},"flowctl"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"flowctl")," command-line interface is used to test, develop, and deploy Flow catalogs.\nIt is the only Flow binary that you need to work with,\nso distribution and upgrades are all simple."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"flowctl")," includes a number of important sub-commands:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"discover")," auto-creates a catalog specification given a connector and endpoint configuration.\nIt\u2019s an assisted way to configure an endpoint capture and scaffold a Flow project."),(0,o.kt)("p",{parentName:"li"},(0,o.kt)("a",{parentName:"p",href:"/concepts/connectors#flowctl-discover"},"Learn more about ",(0,o.kt)("inlineCode",{parentName:"a"},"flowctl discover")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"temp-data-plane")," starts a local, ephemeral Flow data plane.\nIt runs a complete deployment of the Flow runtime,\nbut shrunk down to your local machine instead of a data center.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"deploy")," builds from catalog sources and deploys into a Flow data plane.\nIt's typically used to deploy to a temporary data plane for local development.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"test")," builds from catalog sources and runs all of your catalog tests."))),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"For help while using the ",(0,o.kt)("inlineCode",{parentName:"p"},"flowctl")," CLI, use ",(0,o.kt)("inlineCode",{parentName:"p"},"--help")," after any subcommand for more information."))),(0,o.kt)("h2",{id:"build-directory"},"Build directory"),(0,o.kt)("p",null,"When building Flow catalogs, ",(0,o.kt)("inlineCode",{parentName:"p"},"flowctl")," uses a ",(0,o.kt)("strong",{parentName:"p"},"build directory"),"\nwhich is typically the root directory of your project, and is controlled by flag ",(0,o.kt)("inlineCode",{parentName:"p"},"--directory"),".\nWithin this directory, ",(0,o.kt)("inlineCode",{parentName:"p"},"flowctl")," creates a number of files and sub-directories.\nExcept where noted, it's recommended that these outputs be committed within your GitOps project."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"flow_generated/"),": \u267b\nDirectory of generated files, including TypeScript classes and interfaces.\nSee ",(0,o.kt)("a",{parentName:"p",href:"#typescript-code-generation"},"Typescript code generation"),".")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"*.flow.ts"),": \u2693\nTypeScript modules that accompany your catalog source files.\nA stub is generated for you if your catalog source uses a TypeScript lambda, and a module doesn't yet exist.\nSee ",(0,o.kt)("a",{parentName:"p",href:"#typescript-code-generation"},"Typescript code generation")," and\n",(0,o.kt)("a",{parentName:"p",href:"/concepts/import#typescript-modules"},"learn how TypeScript modules are imported"),".")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"dist/"),": \u267b\nHolds JavaScript and source map files produced during TypeScript compilation.\n",(0,o.kt)("inlineCode",{parentName:"p"},"dist/")," should be added to your ",(0,o.kt)("inlineCode",{parentName:"p"},".gitignore"),".")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"node_modules/"),": \u267b\nLocation where ",(0,o.kt)("inlineCode",{parentName:"p"},"npm")," will download your TypeScript dependencies.\n",(0,o.kt)("inlineCode",{parentName:"p"},"node_modules/")," should be added to your ",(0,o.kt)("inlineCode",{parentName:"p"},".gitignore"),".")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"package.json")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"package-lock.json"),": \u267b\nFiles used by ",(0,o.kt)("inlineCode",{parentName:"p"},"npm")," to manage dependencies and your catalog's associated JavaScript project.\nYou may customize ",(0,o.kt)("inlineCode",{parentName:"p"},"package.json"),",\nbut its ",(0,o.kt)("inlineCode",{parentName:"p"},"dependencies")," stanza will be overwritten by the\n",(0,o.kt)("a",{parentName:"p",href:"/concepts/import#npm-dependencies"},"npmDependencies"),"\nof your catalog source files.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},".eslintrc.js"),": \u2693\nConfigures the TypeScript linter that's run as part of the catalog build process.\nLinting supplements TypeScript compilation to catch additional common mistakes and errors at build time.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},".prettierrc.js"),": \u2693\nConfigures the formatter that's used to format your TypeScript files."))),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Legend")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"\u2693: Generated only if it does not exist. Never modified or deleted by ",(0,o.kt)("inlineCode",{parentName:"p"},"flowctl"),"."),(0,o.kt)("p",{parentName:"div"},"\u267b: ",(0,o.kt)("inlineCode",{parentName:"p"},"flowctl")," re-generates and overwrites contents."))),(0,o.kt)("h3",{id:"typescript-code-generation"},"TypeScript code generation"),(0,o.kt)("p",null,"As part of the catalog build process, Flow translates your\n",(0,o.kt)("a",{parentName:"p",href:"/concepts/schemas"},"schemas"),"\ninto equivalent TypeScript types on your behalf.\nThese definitions live within ",(0,o.kt)("inlineCode",{parentName:"p"},"flow_generated/")," in your catalog build directory,\nand are frequently over-written by invocations of ",(0,o.kt)("inlineCode",{parentName:"p"},"flowctl"),".\nFiles in this subdirectory are human-readable and stable.\nYou may want to commit them as part of a GitOps-managed project, but this isn't required."),(0,o.kt)("p",null,"Flow also generates TypeScript module stubs for Flow catalog sources, which reference\na TypeScript lambda, if that particular Flow catalog source doesn't yet have an accompanying TypeScript module.\nGenerated stubs include implementations of the required TypeScript interfaces,\nwith all method signatures filled out for you:"),(0,o.kt)(i.Z,{mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"acmeBank.flow.yaml",default:!0,mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"collections:\n  acmeBank/balances:\n    schema: balances.schema.yaml\n    key: [/account]\n\n    derivation:\n      transform:\n        fromTransfers:\n          source: { name: acmeBank/transfers }\n          publish: { lambda: typescript }\n"))),(0,o.kt)(l.Z,{value:"acmeBank.flow.ts (generated stub)",default:!0,mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"import { collections, interfaces, registers } from 'flow/modules';\n\n// Implementation for derivation examples/acmeBank.flow.yaml#/collections/acmeBank~1balances/derivation.\nexport class AcmeBankBalances implements interfaces.AcmeBankBalances {\n    fromTransfersPublish(\n        _source: collections.AcmeBankTransfers,\n        _register: registers.AcmeBankBalances,\n        _previous: registers.AcmeBankBalances,\n    ): collections.AcmeBankBalances[] {\n        throw new Error(\"Not implemented\");\n    }\n}\n")))),(0,o.kt)("p",null,"If a TypeScript module exists, ",(0,o.kt)("inlineCode",{parentName:"p"},"flowctl")," will never over-write it,\neven if you update or expand your catalog sources such that the required interfaces have changed."),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"If you make changes to a catalog source file ",(0,o.kt)("inlineCode",{parentName:"p"},"my.flow.yaml")," that substantially\nchange the required TypeScript interfaces, try re-naming an existing\n",(0,o.kt)("inlineCode",{parentName:"p"},"my.flow.ts")," to another name like ",(0,o.kt)("inlineCode",{parentName:"p"},"old.flow.ts"),"."),(0,o.kt)("p",{parentName:"div"},"Then run ",(0,o.kt)("inlineCode",{parentName:"p"},"flowctl check")," to re-generate a new implementation stub,\nwhich will have correct interfaces and can be updated from the definitions of ",(0,o.kt)("inlineCode",{parentName:"p"},"old.flow.ts"),"."))))}f.isMDXComponent=!0}}]);