"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[9184],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return u}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var d=a.createContext({}),s=function(e){var t=a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=s(e.components);return a.createElement(d.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,d=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),m=s(n),u=r,k=m["".concat(d,".").concat(u)]||m[u]||c[u]||i;return n?a.createElement(k,l(l({ref:t},p),{},{components:n})):a.createElement(k,l({ref:t},p))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=m;var o={};for(var d in t)hasOwnProperty.call(t,d)&&(o[d]=t[d]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var s=2;s<i;s++)l[s]=n[s];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},1358:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return o},contentTitle:function(){return d},metadata:function(){return s},toc:function(){return p},default:function(){return m}});var a=n(7462),r=n(3366),i=(n(7294),n(3905)),l=["components"],o={sidebar_position:2},d="Elasticsearch",s={unversionedId:"reference/Connectors/materialization-connectors/Elasticsearch",id:"reference/Connectors/materialization-connectors/Elasticsearch",title:"Elasticsearch",description:"This connector materializes Flow collections into indices in an Elasticsearch cluster.",source:"@site/docs/reference/Connectors/materialization-connectors/Elasticsearch.md",sourceDirName:"reference/Connectors/materialization-connectors",slug:"/reference/Connectors/materialization-connectors/Elasticsearch",permalink:"/reference/Connectors/materialization-connectors/Elasticsearch",editUrl:"https://github.com/estuary/flow/edit/master/site/docs/reference/Connectors/materialization-connectors/Elasticsearch.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Apache Parquet in S3",permalink:"/reference/Connectors/materialization-connectors/Parquet"},next:{title:"Firebolt",permalink:"/reference/Connectors/materialization-connectors/Firebolt"}},p=[{value:"Prerequisites",id:"prerequisites",children:[],level:2},{value:"Configuration",id:"configuration",children:[{value:"Properties",id:"properties",children:[{value:"Endpoint",id:"endpoint",children:[],level:4},{value:"Bindings",id:"bindings",children:[],level:4}],level:3},{value:"Sample",id:"sample",children:[],level:3}],level:2},{value:"Delta updates",id:"delta-updates",children:[],level:2}],c={toc:p};function m(e){var t=e.components,n=(0,r.Z)(e,l);return(0,i.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"elasticsearch"},"Elasticsearch"),(0,i.kt)("p",null,"This connector materializes Flow collections into indices in an Elasticsearch cluster."),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://ghcr.io/estuary/materialize-elasticsearch:dev"},(0,i.kt)("inlineCode",{parentName:"a"},"ghcr.io/estuary/materialize-elasticsearch:dev"))," provides the latest connector image. You can also follow the link in your browser to see past image versions."),(0,i.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,i.kt)("p",null,"To use this connector, you'll need:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"An Elastic cluster with a known ",(0,i.kt)("a",{parentName:"li",href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/getting-started.html#send-requests-to-elasticsearch"},"endpoint"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"If the cluster is on the Elastic Cloud, you'll need an Elastic user with a role that grants all privileges on indices you plan to materialize to within the cluster.\nSee Elastic's documentation on ",(0,i.kt)("a",{parentName:"li",href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/defining-roles.html#roles-indices-priv"},"defining roles")," and\n",(0,i.kt)("a",{parentName:"li",href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/security-privileges.html#privileges-list-indices"},"security privileges"),"."))),(0,i.kt)("li",{parentName:"ul"},"At least one Flow collection")),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"If you haven't yet captured your data from its external source, start at the beginning of the ",(0,i.kt)("a",{parentName:"p",href:"/guides/create-dataflow"},"guide to create a dataflow"),". You'll be referred back to this connector-specific documentation at the appropriate steps."))),(0,i.kt)("h2",{id:"configuration"},"Configuration"),(0,i.kt)("p",null,"To use this connector, begin with data in one or more Flow collections.\nUse the below properties to configure an Elasticsearch materialization, which will direct the contents of these Flow collections into Elasticsearch indices."),(0,i.kt)("p",null,"By default, the connector attempts to map each field in the Flow collection to the most appropriate Elasticsearch ",(0,i.kt)("a",{parentName:"p",href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-types.html"},"field type"),".\nHowever, because each JSON field type can map to multiple Elasticsearch field types,\nyou may want to override the defaults.\nYou can configure this by adding ",(0,i.kt)("inlineCode",{parentName:"p"},"field_overrides")," to the collection's ",(0,i.kt)("a",{parentName:"p",href:"#bindings"},"binding")," in the materialization specification.\nTo do so, provide a JSON pointer to the field in the collection schema, choose the output field type, and specify additional properties, if necessary."),(0,i.kt)("h3",{id:"properties"},"Properties"),(0,i.kt)("h4",{id:"endpoint"},"Endpoint"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Property"),(0,i.kt)("th",{parentName:"tr",align:null},"Title"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"),(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Required/Default"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("inlineCode",{parentName:"strong"},"/endpoint"))),(0,i.kt)("td",{parentName:"tr",align:null},"Endpoint"),(0,i.kt)("td",{parentName:"tr",align:null},"Endpoint host or URL. If using Elastic Cloud, this follows the format ",(0,i.kt)("inlineCode",{parentName:"td"},"https://CLUSTER_ID.REGION.CLOUD_PLATFORM.DOMAIN:PORT"),"."),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"Required")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"/password")),(0,i.kt)("td",{parentName:"tr",align:null},"Password"),(0,i.kt)("td",{parentName:"tr",align:null},"Password to connect to the endpoint."),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"/username")),(0,i.kt)("td",{parentName:"tr",align:null},"Username"),(0,i.kt)("td",{parentName:"tr",align:null},"User to connect to the endpoint."),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null})))),(0,i.kt)("h4",{id:"bindings"},"Bindings"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Property"),(0,i.kt)("th",{parentName:"tr",align:null},"Title"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"),(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Required/Default"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("inlineCode",{parentName:"strong"},"/delta_updates"))),(0,i.kt)("td",{parentName:"tr",align:null},"Delta updates"),(0,i.kt)("td",{parentName:"tr",align:null},"Whether to use standard or ",(0,i.kt)("a",{parentName:"td",href:"#delta-updates"},"delta updates")),(0,i.kt)("td",{parentName:"tr",align:null},"boolean"),(0,i.kt)("td",{parentName:"tr",align:null},"Required")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("inlineCode",{parentName:"strong"},"/field_overrides"))),(0,i.kt)("td",{parentName:"tr",align:null},"Field overrides"),(0,i.kt)("td",{parentName:"tr",align:null},"Assign Elastic field type to each collection field."),(0,i.kt)("td",{parentName:"tr",align:null},"array"),(0,i.kt)("td",{parentName:"tr",align:null},"Required")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},(0,i.kt)("inlineCode",{parentName:"em"},"/field_overrides/-/es_type"))),(0,i.kt)("td",{parentName:"tr",align:null},"Elasticsearch type"),(0,i.kt)("td",{parentName:"tr",align:null},"The overriding Elasticsearch data type of the field."),(0,i.kt)("td",{parentName:"tr",align:null},"object"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},(0,i.kt)("inlineCode",{parentName:"em"},"/field_overrides/-/es_type/date_spec"))),(0,i.kt)("td",{parentName:"tr",align:null},"Date specifications"),(0,i.kt)("td",{parentName:"tr",align:null},"Configuration for the date field, effective if field","_","type is ","'","date","'",". See ",(0,i.kt)("a",{parentName:"td",href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/date.html"},"Elasticsearch docs"),"."),(0,i.kt)("td",{parentName:"tr",align:null},"object"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},(0,i.kt)("inlineCode",{parentName:"em"},"/field_overrides/-/es_type/date_spec/format"))),(0,i.kt)("td",{parentName:"tr",align:null},"Date format"),(0,i.kt)("td",{parentName:"tr",align:null},"Format of the date. See ",(0,i.kt)("a",{parentName:"td",href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-date-format.html"},"Elasticsearch docs"),"."),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},(0,i.kt)("inlineCode",{parentName:"em"},"/field_overrides/-/es_type/field_type"))),(0,i.kt)("td",{parentName:"tr",align:null},"Field type"),(0,i.kt)("td",{parentName:"tr",align:null},"The Elasticsearch field data types. Supported types include: boolean, date, double, geo","_","point, geo","_","shape, keyword, long, null, text."),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},(0,i.kt)("inlineCode",{parentName:"em"},"/field_overrides/-/es_type/keyword_spec"))),(0,i.kt)("td",{parentName:"tr",align:null},"Keyword specifications"),(0,i.kt)("td",{parentName:"tr",align:null},"Configuration for the keyword field, effective if field","_","type is ","'","keyword","'",". See ",(0,i.kt)("a",{parentName:"td",href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/keyword.html"},"Elasticsearch docs")),(0,i.kt)("td",{parentName:"tr",align:null},"object"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},(0,i.kt)("inlineCode",{parentName:"em"},"/field_overrides/-/es_type/keyword_spec/ignore_above"))),(0,i.kt)("td",{parentName:"tr",align:null},"Ignore above"),(0,i.kt)("td",{parentName:"tr",align:null},"Strings longer than the ignore","_","above setting will not be indexed or stored. See ",(0,i.kt)("a",{parentName:"td",href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/ignore-above.html"},"Elasticsearch docs")),(0,i.kt)("td",{parentName:"tr",align:null},"integer"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},(0,i.kt)("inlineCode",{parentName:"em"},"/field_overrides/-/es_type/text_spec"))),(0,i.kt)("td",{parentName:"tr",align:null},"Text specifications"),(0,i.kt)("td",{parentName:"tr",align:null},"Configuration for the text field, effective if field","_","type is ","'","text","'","."),(0,i.kt)("td",{parentName:"tr",align:null},"object"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},(0,i.kt)("inlineCode",{parentName:"em"},"/field_overrides/-/es_type/text_spec/dual_keyword"))),(0,i.kt)("td",{parentName:"tr",align:null},"Dual keyword"),(0,i.kt)("td",{parentName:"tr",align:null},"Whether or not to specify the field as text","/","keyword dual field."),(0,i.kt)("td",{parentName:"tr",align:null},"boolean"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},(0,i.kt)("inlineCode",{parentName:"em"},"/field_overrides/-/es_type/text_spec/keyword_ignore_above"))),(0,i.kt)("td",{parentName:"tr",align:null},"Ignore above"),(0,i.kt)("td",{parentName:"tr",align:null},"Effective only if Dual Keyword is enabled. Strings longer than the ignore","_","above setting will not be indexed or stored. See ",(0,i.kt)("a",{parentName:"td",href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/ignore-above.html"},"Elasticsearch docs"),"."),(0,i.kt)("td",{parentName:"tr",align:null},"integer"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},(0,i.kt)("inlineCode",{parentName:"em"},"/field_overrides/-/pointer"))),(0,i.kt)("td",{parentName:"tr",align:null},"Pointer"),(0,i.kt)("td",{parentName:"tr",align:null},"A ","'","/","'","-delimited json pointer to the location of the overridden field."),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("inlineCode",{parentName:"strong"},"/index"))),(0,i.kt)("td",{parentName:"tr",align:null},"index"),(0,i.kt)("td",{parentName:"tr",align:null},"Name of the ElasticSearch index to store the materialization results."),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"Required")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"/number_of_replicas")),(0,i.kt)("td",{parentName:"tr",align:null},"Number of replicas"),(0,i.kt)("td",{parentName:"tr",align:null},"The number of replicas in ElasticSearch index. If not set, default to be 0. For single-node clusters, make sure this field is 0, because the Elastic search needs to allocate replicas on different nodes."),(0,i.kt)("td",{parentName:"tr",align:null},"integer"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"0"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"/number_of_shards")),(0,i.kt)("td",{parentName:"tr",align:null},"Number of shards"),(0,i.kt)("td",{parentName:"tr",align:null},"The number of shards in ElasticSearch index. Must set to be greater than 0."),(0,i.kt)("td",{parentName:"tr",align:null},"integer"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"1"))))),(0,i.kt)("h3",{id:"sample"},"Sample"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"materializations:\n  tenant/mat_name:\n    endpoint:\n      connector:\n         # Path to the latest version of the connector, provided as a Docker image\n        image: ghcr.io/estuary/materialize-elasticsearch:dev\n        config:\n          endpoint: https://ec47fc4d2c53414e1307e85726d4b9bb.us-east-1.aws.found.io:9243\n          username: flow_user\n          password: secret\n    # If you have multiple collections you need to materialize, add a binding for each one\n    # to ensure complete data flow-through\n        bindings:\n          - resource:\n              index: last-updated\n              delta_updates: false\n              field_overrides:\n                  - pointer: /updated-date\n                    es_type:\n                      field_type: date\n                        date_spec:\n                          format: yyyy-MM-dd\n            source: tenant/source_collection\n")),(0,i.kt)("h2",{id:"delta-updates"},"Delta updates"),(0,i.kt)("p",null,"This connector supports both standard and delta updates. You must choose an option for each binding."),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/concepts/materialization#delta-updates"},"Learn more about delta updates")," and the implications of using each update type."))}m.isMDXComponent=!0}}]);